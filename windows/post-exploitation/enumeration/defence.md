---
icon: shield
---

# Defence

### **Defender Status**

```powershell
C:\> sc query windefend
```

```powershell
PS C:\> Get-MpComputerStatus
```

### **List AppLocker Rules**

```powershell
PS C:\> Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
```

### **Test AppLocker Policy**

```powershell
PS C:\> Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
```

### **PowerShell Constrained Language Mode**

```powershell
PS C:\> $ExecutionContext.SessionState.LanguageMode
```

### **LAPS**

```powershell
PS C:\> Find-LAPSDelegatedGroups # Lists groups/users with permission to retrieve LAPS-managed passwords
PS C:\> Find-AdmPwdExtendedRights # Identifies who can read LAPS-stored local admin passwords
PS C:\> Get-LAPSComputers # Retrieves a list of computers managed by LAPS
```

### **Check Firewall**

```powershell
PS C:\> netsh advfirewall show allprofiles
```
