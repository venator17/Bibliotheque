---
icon: square-poll-vertical
---

# Enumeration

## <mark style="color:yellow;">ABOUT</mark>

In any situation, whether daily life or a network penetration test, <mark style="color:orange;">**understanding our surroundings is crucial**</mark>. This awareness allows us to make informed, proactive decisions. We may discover accessible hosts, protections to bypass, or tools incompatible with the target system.

## <mark style="color:yellow;">Data Sources</mark>

* **Installed applications**
* **Installed services**
  * Websites
  * File Shares
  * Databases
  * Directory Services (such as Active Directory, Azure AD, etc.)
  * Name Servers
  * Deployment Services
  * Certificate Authority
  * Source Code Management Server
  * Virtualization
  * Messaging
  * Monitoring and Logging Systems
  * Backups
* **Sensitive Data**
  * Keylogging
  * Screen Capture
  * Network Traffic Capture
  * Previous Audit reports
* **User Information**
  * History files, interesting documents (.doc/x,.xls/x,password./pass., etc)
  * Roles and Privileges
  * Web Browsers
  * IM Clients

## <mark style="color:yellow;">NETWORK</mark>

#### Display network connections:

```powershell
C:\> netstat -ano
# OR for certain port
C:\> netstat -ano | findstr 1337
```

#### Network Configs

```powershell
C:\> ipconfig /all
```

#### ARP Table

```powershell
C:\> arp -a
```

#### **Routing** **Table**

```powershell
C:\> route print
```

## <mark style="color:yellow;">USERS / GROUPS</mark>

#### **Check logged-in users:**

<pre class="language-powershell"><code class="lang-powershell">C:\> query user

<strong>C:\> whoami /user
</strong></code></pre>

#### **View current user context:**

```powershell
C:\> echo %USERNAME%
```

#### **View current user privileges:**

```powershell
C:\> whoami /priv
```

#### **View current user group memberships:**

```powershell
C:\> whoami /groups
```

#### **List all users on the system:**

```powershell
C:\> net user
```

#### **List all groups on the system:**

```powershell
C:\> net localgroup
```

#### **Get details of a specific group:**

```powershell
C:\> net localgroup {GROUPNAME}
As example net localgroup administrators
```

#### **View password policy and account settings:**

```powershell
C:\> net accounts
```

#### **Check Local User Description Field**

```powershell
PS C:\> Get-LocalUser
```

## <mark style="color:yellow;">PROCESSES / SERVICES</mark>

#### **View running processes and services:**

```powershell
C:\> tasklist /svc
```

#### View service by PID

```powershell
C:\> tasklist /FI "PID eq 1337"
```

```powershell
PS C:\> Get-WmiObject Win32_Process -Filter "ProcessId = 1337" | Select-Object Name, ProcessId, CommandLine
```

```powershell
PS C:\> get-process -Id 1337
```

#### Get service by name

```powershell
PS C:\> get-service | ? {$_.DisplayName -like 'AMOGUS*'}
```

## <mark style="color:yellow;">SYSTEM</mark>

#### **Display environment variables:**

```powershell
C:\> set
```

#### **Gather system info**

```powershell
C:\> systeminfo
```

#### Checking Build Info

```powershell
PS C:\> [environment]::OSVersion.Version
```

#### Checking UAC

```powershell
# If it's enabled
C:\> REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA
# Checking UAC Prompt Level
C:\> REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v ConsentPromptBehaviorAdmin
```

#### Check **Computer Description Field**

```powershell
PS C:\> Get-WmiObject -Class Win32_OperatingSystem | select Description
```

## <mark style="color:yellow;">PERMISSIONS</mark>

#### Check privileges

```powershell
whoami /priv
```

#### Check Group Policies

```powershell
gpresult /r   
```

## <mark style="color:yellow;">PROGRAMS</mark>

#### List installed programs:

```powershell
C:\> wmic product get name
```

```powershell
PS C:\> Get-WmiObject -Class Win32_Product | Select-Object Name, Version
```

```powershell
PS C:\> $INSTALLED = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* |  Select-Object DisplayName, DisplayVersion, InstallLocation
PS C:\> $INSTALLED += Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, InstallLocation
PS C:\> $INSTALLED | ?{ $_.DisplayName -ne $null } | sort-object -Property DisplayName -Unique | Format-Table -AutoSize
```

**View patches and updates:**

```powershell
C:\> wmic qfe
```

```powershell
PS C:\> Get-HotFix | ft -AutoSize
```

## <mark style="color:yellow;">PROTECTIONS</mark>

#### Defender Status

```powershell
PS C:\> Get-MpComputerStatus
```

#### **List AppLocker Rules**

```powershell
PS C:\> Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
```

#### **Test AppLocker Policy**

```powershell
PS C:\> Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
```

## <mark style="color:yellow;">NAMED PIPES</mark>

#### **Listing Named Pipes**

```powershell
C:\> pipelist.exe /accepteula
```

```powershell
PS C:\> gci \\.\pipe\
```

#### **Reviewing LSASS Named Pipe Permissions**

```powershell
C:\> accesschk.exe /accepteula \\.\Pipe\lsass -v
```

## <mark style="color:yellow;">SCHEDULED TASKS</mark>

```powershell
C:\> schtasks /query /fo LIST /v
```

```powershell
PS C:\> Get-ScheduledTask | select TaskName,State
```

## <mark style="color:yellow;">FILES</mark>

#### Get more info about file

```powershell
PS C:\> Get-ChildItem -Path 'C:\Share\file.txt' | Select Fullname,LastWriteTime,Attributes,@{Name="Owner";Expression={ (Get-Acl $_.FullName).Owner }}
```

### Files of Interest

| **File**                                                                         | **Explanation**                                                                          |
| -------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| <mark style="color:blue;">`C:\Windows\System32\config\SAM`</mark>                | Stores user account information.                                                         |
| <mark style="color:blue;">`C:\Windows\System32\config\system`</mark>             | Contains system startup settings and driver configurations.                              |
| <mark style="color:blue;">`C:\Windows\System32\config\software`</mark>           | Contains software installation and configuration data.                                   |
| <mark style="color:blue;">`C:\Windows\System32\config\security`</mark>           | Stores security settings and permissions.                                                |
| <mark style="color:blue;">`C:\Windows\System32\config\default`</mark>            | Contains default user profile settings.                                                  |
| <mark style="color:blue;">`C:\Windows\System32\config\RegBack`</mark>            | Backup registry files for system recovery.                                               |
| <mark style="color:blue;">`%WINDIR%\win.ini`</mark>                              | Contains system settings for Windows.                                                    |
| <mark style="color:blue;">`%WINDIR%\system32\config\txr\{guid}\*.log`</mark>     | Logs of file system changes.                                                             |
| <mark style="color:blue;">`C:\Windows\System32\winevt\Logs\Security.evtx`</mark> | Security event log with information about logins and security events.                    |
| <mark style="color:blue;">`%APPDATA%\Microsoft\Windows\Recent`</mark>            | Contains shortcuts to recently opened files.                                             |
| <mark style="color:blue;">`%SYSTEMDRIVE%\$Recycle.Bin`</mark>                    | Stores deleted files that can be recovered.                                              |
| <mark style="color:blue;">`C:\Users\<username>\AppData\Local\Temp`</mark>        | Temporary files that may contain sensitive data or tools.                                |
| <mark style="color:blue;">`C:\Windows\System32\drivers\etc\hosts`</mark>         | Maps IP addresses to hostnames, useful for detecting malicious redirections.             |
| <mark style="color:blue;">`%WINDIR%\System32\drivers\etc\networks`</mark>        | Contains system network interface configurations.                                        |
| <mark style="color:blue;">`C:\Windows\System32\config\hivelist`</mark>           | Backup of the registry hives, useful for recovery or data extraction.                    |
| <mark style="color:blue;">`C:\Windows\System32\config\software.log`</mark>       | Tracks changes to software configurations.                                               |
| <mark style="color:blue;">`C:\inetpub\wwwroot\web.config`</mark>                 | Configures IIS web apps, may contain sensitive data like connection strings or settings. |
