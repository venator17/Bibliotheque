# SNMP

## About

<mark style="color:red;">**SNMP (Simple Network Management Protocol)**</mark> is an application-layer Internet Standard protocol used for <mark style="color:purple;">**managing information about devices on an IP network**</mark>. It can also be used to **modify the device information and change device behavior**. The protocol lets devices on the same network communicate with each other and is commonly used for collecting information about the health and status of the devices on the network. SNMP also transmits control commands using agents over <mark style="color:yellow;">**UDP port 161 and sometimes port 162**</mark>

* <mark style="color:blue;">**OID**</mark> - <mark style="color:red;">**Object Identifier**</mark>. An OID represents a node in a hierarchical namespace. A sequence of numbers uniquely identifies each node, allowing the node's position in the tree to be determined.
* <mark style="color:blue;">**MIB**</mark> - <mark style="color:red;">**Management Information Base**</mark>. MIB is an independent format for storing device information. A MIB is a <mark style="color:yellow;">**text file**</mark> in which all queryable SNMP objects of a device are listed in a standardized tree hierarchy. It contains at least one OID
* <mark style="color:blue;">**Community String**</mark> -  Is essentially a <mark style="color:purple;">**password or authentication string**</mark> used to grant access to devices in an SNMP-managed network. It acts as a form of security to restrict access to the SNMP agent running on a device.

## Versions

1. <mark style="color:blue;">**`SNMPv1`**</mark> - No authentification. For SNMPwalk use <mark style="color:green;">`-v1`</mark> argument to use.
2. <mark style="color:blue;">**`SNMPv2`**</mark> - No encryption. Community strings can be seen as passwords that are used to determine whether the requested information can be viewed or not. Also could be called as <mark style="color:blue;">**`v2c`**</mark>, which means**v2 community** In <mark style="color:blue;">**`v2c`**</mark> can be intercepted.
3. <mark style="color:blue;">**`SNMPv3`**</mark> - Finally now it has authentification and encryption. That's a win.

## Dangerous Settings

**View config file**

```bash
cat /etc/snmp/snmpd.conf | grep -v "#" | sed -r '/^\s*$/d'
```

* <mark style="color:green;">`rwuser noauth`</mark> - Provides access to the full OID tree without authentication.
* <mark style="color:green;">`rwcommunity <community string> <IPv4 address>`</mark> - Provides access to the full OID tree regardless of where the requests were sent from.
* <mark style="color:green;">`rwcommunity6 <community string> <IPv6 address>`</mark> - Same access as with rwcommunity with the difference of using IPv6.

## SNMPwalk

<mark style="color:red;">**SNMPwalk**</mark> is an application that <mark style="color:purple;">**repeatedly sends out GetNextRequest to collect information about different OIDs**</mark>. The application bundles together multiple SNMP commands and lets you collect information from multiple devices without having to type out individual commands for all OIDs. It can help you identify devices in the network that are not working. By performing an SNMP walk, you can find out the entire list of devices in your network that supports SNMP and form a library of MIBs.

#### SNMPwalk

```bash
snmpwalk -v2c -c public 13.13.13.13
```

## Tips2Hack

1. <mark style="color:red;">**OneSixtyOne**</mark> (SNMP scanner). Can be used to brute-force the names of the community strings since they can be named arbitrarily by the administrator

```bash
onesixtyone -c /opt/useful/SecLists/Discovery/SNMP/snmp.txt 13.13.13.13
```

2. <mark style="color:red;">**Braa**</mark>. Once we know a community string, we can use it with braa to brute-force the individual OIDs and enumerate the information behind them.

```bash
> braa <community string>@13.13.13.13:.1.3.6.*
```
